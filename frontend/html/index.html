<!doctype html>

<title>CodeMirror: Vim bindings demo</title>
<meta charset="utf-8"/>

<link rel="stylesheet" href="css/codemirror.css">
<link rel="stylesheet" href="css/dialog.css">
<link rel="stylesheet" href="css/midnight.css">
<link rel="stylesheet" href="css/solarized.css">
<script src="lib/codemirror.js"></script>
<script src="lib/searchcursor.js"></script>
<script src="lib/dialog.js"></script>
<script src="lib/clike.js"></script>
<script src="lib/matchbrackets.js"></script>
<script src="lib/vim.js"></script>
<style>
.CodeMirror {border-top: 1px solid #eee; border-bottom: 1px solid #eee;}
</style>
<div id=nav>
    <form><textarea id="code" name="code">
            #include "syscalls.h"
            /* getchar:  simple buffered version */
            int getchar(void)
            {
            static char buf[BUFSIZ];
            static char *bufp = buf;
            static int n = 0;
            if (n == 0) {  /* buffer is empty */
            n = read(0, buf, sizeof buf);
            bufp = buf;
            }
            return (--n >= 0) ? (unsigned char) *bufp++ : EOF;
            }
        </textarea></form>
        <div style="font-size: 13px; width: 300px; height: 30px;">Key buffer: <span id="command-display"></span></div>
        <div style="font-size: 13px; width: 300px; height: 30px;">Vim mode: <span id="vim-mode"></span></div>

        <p><strong>Features</strong></p>

        <ul>
            <li>All common motions and operators, including text objects</li>
            <li>Operator motion orthogonality</li>
            <li>Visual mode - characterwise, linewise, blockwise</li>
            <li>Full macro support (q, @)</li>
            <li>Incremental highlighted search (/, ?, #, *, g#, g*)</li>
            <li>Search/replace with confirm (:substitute, :%s)</li>
            <li>Search history</li>
            <li>Jump lists (Ctrl-o, Ctrl-i)</li>
            <li>Key/command mapping with API (:map, :nmap, :vmap)</li>
            <li>Sort (:sort)</li>
            <li>Marks (`, ')</li>
            <li>:global</li>
            <li>Insert mode behaves identical to base CodeMirror</li>
            <li>Cross-buffer yank/paste</li>
        </ul>

        <script>
            CodeMirror.commands.save = function(){ alert("Saving"); };
var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
    lineNumbers: true,
    mode: "text/x-csrc",
    keyMap: "vim",
    matchBrackets: true,
    showCursorWhenSelecting: true
});
var commandDisplay = document.getElementById('command-display');
var keys = '';
CodeMirror.on(editor, 'vim-keypress', function(key) {
    keys = keys + key;
    commandDisplay.innerText = keys;
});
CodeMirror.on(editor, 'vim-command-done', function(e) {
    keys = '';
    commandDisplay.innerHTML = keys;
});
var vimMode = document.getElementById('vim-mode');
CodeMirror.on(editor, 'vim-mode-change', function(e) {
    vimMode.innerText = JSON.stringify(e);
});
        </script>
